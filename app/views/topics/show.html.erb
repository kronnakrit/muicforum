<ol class="breadcrumb">
  <li><%= link_to 'Home', boards_path %></li>
  <li><%= link_to @board.title, @board %></li>
  <li><%= link_to @topic.title.truncate(30), @topic %>
</ol><p id="notice"><%= notice %></p>
 
<div class="panel panel-default">
  	<div class="panel-heading" style="background-color: white;">
	    	<h3 class="panel-title" style="font-size: 30px; color: #586996;"><%= @topic.title.squish.gsub(/(.{50})(?=.)/, '\1 \2') %>
			<div class="delete-post-btn">
			    <% if(current_user.id == @topic.user.id || current_user.admin?) %>
					<div class="btn-group" style="float: right;">
					   	<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" >
    						<span class="caret"></span>
  						</button>		
					  <ul class="dropdown-menu" role="menu">
					    <li><%= link_to edit_board_topic_path(@board, @topic) do%>
								<i class="fa fa-pencil"></i> Edit
							<% end %>
					    </li>
					    <li><%= link_to @topic, method: :delete,
					                                  data: { confirm: "Are you sure?" } do%>
								<i class="fa fa-eraser"></i> Delete
							<% end %>
					    </li>
					  </ul>
					</li>
				<% end %>
			</div>
		</h3>
		<p id="tagging">Tags: <%= raw @topic.keyword_list.map { |t| link_to t, tag_path(t) }.join(' ') %></p>
 	 </div>
  	<div class="panel-body" >
    	<%= @topic.subtitle %>
  	</div>
    <div class="panel-footer">
		
		<% if current_user.voted_for? @topic %>
			<%= form_tag url_for(:controller => "topics", :action => 'unlike'), class: "likebutton" do %>
				<%= button_tag(:name => nil, class: "btn btn-default likebuttontag") do %>
		  				<i class="fa fa-plus-circle fa-3 blueicon" style="zoom: 3; margin-left: -4px; margin-top: -2px;"></i>
		  				<%end%>
			<% end %>
		<% else %>
			<%= form_tag url_for(:controller => "topics", :action => 'like'), class: "likebutton" do %>
				<%= button_tag(:name => nil, class: "btn btn-warning likebuttontag") do %>
		  				<i class="fa fa-plus-circle fa-3 greyicon" style="zoom: 3; margin-left: -4px; margin-top: -2px;"></i>
		  				<%end%>
			<% end %>
		<% end %>

		<div style=" float: left; margin-left: 3px; margin-right: 15px; margin-bottom:10px; margin-top:7px;" ><span class="badge" style="font-size: 20px;"><i class="fa fa-thumbs-up"></i> <%= @topic.votes.size %></span></div>
	    <div style="margin-top: 5px;"> 
			by <%= link_to @topic.user.name, @topic.user %> <br />
		   	<div style="color: #bbb;">Posted at <%= @topic.created_at.time.localtime.to_formatted_s(:db)%></div>
	    </div>
	    <% if @users.any? %>
			<div class="likelist">
				<% @users.each do |user|%>
						<% if(@users.last != user) %>
							<%= link_to user.name, user %>, 
						<% else %>
							<%= link_to user.name, user %>
						<% end %>
				<% end %>
			</div>
		<% end %>
    </div>
</div>
<% @count = 0 %>
<% @topic.comments.each do |comment| %>
	<% @count = @count + 1 %>
	<div class="panel panel-default">
		<div id="comment">
			Comment #<%= @count %>
		</div>
		<% if(current_user.id == comment.user.id || current_user.admin?) %>
					<div class="btn-group" style="float: right;">
					   	<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" >
    						<span class="caret"></span>
  						</button>		
					 	<ul class="dropdown-menu" role="menu">
						 	<div id='basic-modal'>
							    <li><%= link_to [@topic, comment], class: 'basic' do %>
										<i class="fa fa-pencil"></i> Edit
									<% end %>
							    </li>
							</div>
						    <li><%= link_to [@topic, comment], method: :delete,
				                          data: { confirm: "You sure?" } do%>
									<i class="fa fa-eraser"></i> Delete
								<% end %>
				            </li>
					  	</ul>
					</div>
				<% end %>
		
	 	<div class="panel-body" style="margin-bottom: 1em; margin-top: 1.5em">
        	<%=comment.content%>
        	<br/>
	  	</div>
	  	<div class="panel-footer">
	  	<div style="margin-top: 5px;">
		  	by <%= link_to comment.user.name, comment.user %> <br/>
		    <div style="color: #bbb;">Posted At <%= comment.created_at.time.localtime.to_formatted_s(:db)%></div>
	    </div>
	  </div>
	</div>

	<!-- This is modal for edit comment-->
	<div id="basic-modal-content" title="Edit comment">	
			
		<%= form_for([@topic, comment]) do |f| %>
	  		<div class="field">
	    		<%= f.label 'Edit Comment' %>
	    		<%= f.text_area :content, class:"form-control" %>
	  		</div>
	   		<div class="actions" style="text-align: center;">
	    		<%= f.submit "Submit", class: "btn btn-primary"%>
	  		</div>
		<% end %>
			
		<div>
			Press ESC to cancel editing.
		</div>
	</div>

<% end %>

<%= form_for([@topic, @topic.comments.build]) do |f| %>
  <div class="field">
    <%= f.label 'Comment' %>
    <%= f.text_area :content, class:"form-control" %>
  </div>
   <div class="actions" style="text-align: center;">
    <%= f.submit 'Comment',class: "btn btn-primary"%>
  </div>
<% end %>







